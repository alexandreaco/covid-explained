<template>

  <div class="container">

    <a href="#" class="site-name">
      <router-link :to="{ name: 'Home' }">

        <svg version="1.1"
                     xmlns="http://www.w3.org/2000/svg"
                     xmlns:xlink="http://www.w3.org/1999/xlink"
                     x="0px"
                     y="0px"
                     width="403.9188px"
                     height="159.233px"
                     viewBox="0 0 403.9188 159.233"
                     style="enable-background:new 0 0 403.9188 159.233;"
                     xml:space="preserve">
            <g>
            	<rect x="67.8133" y="92.4078" style="fill:#FFFFFF;" width="336.1055" height="66.8252"/>
            </g>
            <g>
            	<g>
            		<polygon style="fill:#33322D;" points="107.3926,141.1516 87.1913,141.1516 87.1913,127.9818 104.4532,127.9818
            			104.4532,122.3911 87.1913,122.3911 87.1913,110.547 107.1908,110.547 107.1908,104.8406 80.2459,104.8406 80.2459,146.8001
            			107.3926,146.8001 		"/>
            	</g>
            	<g>
            		<polygon style="fill:#33322D;" points="120.793,146.8001 129.093,130.9211 137.3924,146.8001 145.4906,146.8001 133.243,125.6478
            			145.2021,104.8406 137.0466,104.8406 128.9779,120.46 121.0237,104.8406 112.9261,104.8406 124.8569,125.6478 112.6086,146.8001
            					"/>
            	</g>
            	<g>
            		<path style="fill:#33322D;" d="M158.1417,130.7194h7.1182c2.0935-0.0185,4.0298-0.3261,5.807-0.9222
            			c1.7767-0.5949,3.3088-1.45,4.5963-2.5647c1.287-1.1141,2.2913-2.4589,3.0116-4.0344c0.7204-1.5754,1.0806-3.3429,1.0806-5.3028
            			c0-2.0172-0.3602-3.828-1.0806-5.4324c-0.7203-1.6038-1.7246-2.9682-3.0116-4.0922c-1.2875-1.1239-2.8196-1.9883-4.5963-2.5936
            			c-1.7772-0.6053-3.7135-0.917-5.807-0.9366h-14.0347v41.9595h6.9164V130.7194z M158.1417,110.4313h7.1182
            			c1.1714,0.0197,2.219,0.2116,3.1411,0.5764c0.9222,0.3654,1.7097,0.8788,2.3629,1.5419c0.6533,0.6626,1.1529,1.4552,1.4986,2.3774
            			c0.3458,0.9222,0.5192,1.931,0.5192,3.0261c0,1.0372-0.1734,1.9981-0.5192,2.8815c-0.3457,0.884-0.8453,1.6431-1.4986,2.2767
            			c-0.6533,0.6343-1.4407,1.1292-2.3629,1.4841c-0.9221,0.3556-1.9697,0.5331-3.1411,0.5331h-7.1182V110.4313z"/>
            	</g>
            	<g>
            		<polygon style="fill:#33322D;" points="213.7035,141.1516 193.7034,141.1516 193.7034,104.8406 186.787,104.8406
            			186.787,146.8001 213.7035,146.8001 		"/>
            	</g>
            	<g>
            		<path style="fill:#33322D;" d="M228.7754,137.0594h13.1125l2.8243,9.7407h7.1176l-13.3715-41.9595h-6.0804l-13.6312,41.9595
            			h7.1472L228.7754,137.0594z M235.4039,114.6964l4.7547,16.4554h-9.6251L235.4039,114.6964z"/>
            	</g>
            	<g>
            		<polygon style="fill:#33322D;" points="282.8386,141.0943 273.761,141.0943 273.761,110.5753 282.8386,110.5753
            			282.8386,104.8406 257.882,104.8406 257.882,110.5753 266.7578,110.5753 266.7578,141.0943 257.882,141.0943 257.882,146.8001
            			282.8386,146.8001 		"/>
            	</g>
            	<g>
            		<polygon style="fill:#33322D;" points="298.8904,117.9242 312.5505,146.8001 319.5242,146.8001 319.5242,104.8406
            			312.5215,104.8406 312.4637,133.6304 298.8615,104.8406 291.8589,104.8406 291.8589,146.8001 298.8615,146.8001 		"/>
            	</g>
            	<g>
            		<polygon style="fill:#33322D;" points="355.3165,141.1516 335.1152,141.1516 335.1152,127.9818 352.3771,127.9818
            			352.3771,122.3911 335.1152,122.3911 335.1152,110.547 355.1147,110.547 355.1147,104.8406 328.1699,104.8406 328.1699,146.8001
            			355.3165,146.8001 		"/>
            	</g>
            	<g>
            		<path style="fill:#33322D;" d="M380.9651,145.3882c2.2664-0.9412,4.1974-2.2623,5.7925-3.9626
            			c1.5939-1.7004,2.8237-3.7366,3.6886-6.1094c0.8643-2.3727,1.306-5.0004,1.3257-7.882v-3.17
            			c-0.0197-2.8821-0.4614-5.5087-1.3257-7.882c-0.8649-2.3721-2.0993-4.4136-3.7031-6.1238
            			c-1.6044-1.7096-3.5545-3.0353-5.8503-3.9771c-2.2958-0.9407-4.8848-1.4211-7.7664-1.4408h-10.2593v41.9595h10.4611
            			C376.1526,146.8001,378.6976,146.3295,380.9651,145.3882z M369.8987,110.4313h3.2278c1.9594,0.0197,3.6644,0.3701,5.1149,1.0522
            			c1.4506,0.6816,2.6561,1.6327,3.6169,2.8526c0.9603,1.2205,1.676,2.6659,2.1467,4.3373s0.7158,3.5157,0.7349,5.5329v3.2278
            			c-0.0191,2.075-0.2642,3.9581-0.7349,5.6486c-0.4706,1.6906-1.1812,3.1365-2.1322,4.3367
            			c-0.9511,1.2008-2.1375,2.1328-3.5591,2.7954c-1.4222,0.6631-3.0839,1.0042-4.9854,1.0233h-3.4296V110.4313z"/>
            	</g>
            	<g>
            		<path style="fill:#33322D;" d="M315,92.4078V0H0v93h67.8133v66.233h336.1055V92.4078H315z M402.7352,158.049H68.9969v-64.457
            			h333.7383V158.049z"/>
            	</g>
            </g>
            <g>
            	<g>
            		<path style="fill:#FFFFFF;" d="M61.3965,60.6338c-0.3301,3.4644-1.1553,6.6245-2.4746,9.478
            			c-1.3203,2.854-3.0684,5.2954-5.2461,7.3247s-4.7441,3.5967-7.6963,4.7017c-2.9531,1.105-6.2451,1.6582-9.874,1.6582
            			c-4.3887,0-8.2158-0.8501-11.4824-2.5488c-3.2656-1.6992-5.9883-4.0005-8.1655-6.9043c-2.1777-2.9033-3.811-6.3018-4.8999-10.1953
            			c-1.0889-3.8931-1.6504-8.0503-1.6826-12.4722v-9.8491c0.0322-4.3877,0.6099-8.5371,1.7319-12.4473
            			c1.1216-3.9097,2.7793-7.3247,4.9741-10.2446c2.1943-2.9199,4.9248-5.229,8.1914-6.9287
            			c3.2656-1.6992,7.0596-2.5488,11.3828-2.5488c3.7939,0,7.1758,0.561,10.1455,1.6826c2.9697,1.1221,5.5098,2.7056,7.6221,4.751
            			c2.1113,2.0464,3.7939,4.5371,5.0479,7.4736c1.2539,2.937,2.0615,6.2031,2.4258,9.7993H49.5176
            			c-0.1973-2.1113-0.6016-4.0337-1.2119-5.7661c-0.6113-1.7319-1.4443-3.2168-2.5-4.4541s-2.3838-2.1855-3.9834-2.8457
            			c-1.6006-0.6597-3.4893-0.9897-5.667-0.9897c-2.6729,0-4.917,0.6108-6.7314,1.8311c-1.8145,1.2212-3.2832,2.8628-4.4043,4.9243
            			c-1.1221,2.0625-1.9229,4.4468-2.4004,7.1519c-0.4785,2.7056-0.7178,5.543-0.7178,8.5127v9.9478
            			c0,3.1016,0.2393,6.0132,0.7178,8.7354c0.4775,2.7222,1.2617,5.1064,2.3506,7.1519c1.0889,2.0459,2.541,3.6621,4.3555,4.8501
            			c1.8145,1.1875,4.0742,1.7817,6.7803,1.7817c4.1572,0,7.3252-1.1792,9.5029-3.5386c2.1777-2.3589,3.4639-5.6997,3.8604-10.0225
            			H61.3965z"/>
            	</g>
            	<g>
            		<path style="fill:#FFFFFF;" d="M122.4199,51.3789c0,4.2563-0.5439,8.3394-1.6328,12.249
            			c-1.0889,3.9102-2.7148,7.3584-4.875,10.3442c-2.1611,2.9863-4.8672,5.3618-8.1172,7.1265
            			c-3.25,1.7651-7.0518,2.6479-11.4072,2.6479c-4.3232,0-8.085-0.8906-11.2842-2.6724c-3.2012-1.7817-5.8652-4.165-7.9932-7.1519
            			c-2.1279-2.9858-3.7285-6.4253-4.8008-10.3188c-1.0723-3.8931-1.6084-7.9683-1.6084-12.2246v-9.2056
            			c0-2.8374,0.2393-5.6089,0.7178-8.3149c0.4775-2.7046,1.1875-5.2534,2.1279-7.6465c0.9404-2.3916,2.1113-4.6025,3.5137-6.6318
            			s3.0518-3.769,4.9492-5.2212c1.8975-1.4517,4.042-2.5898,6.4346-3.415c2.3916-0.8242,5.0234-1.2373,7.8936-1.2373
            			c4.3555,0,8.1582,0.8906,11.4082,2.6724c3.249,1.7817,5.9639,4.166,8.1416,7.1519c2.1777,2.9863,3.8105,6.4424,4.8994,10.3687
            			c1.0889,3.9268,1.6328,8.0176,1.6328,12.2739V51.3789z M110.4931,42.0742c-0.0342-2.7051-0.2812-5.3945-0.7432-8.0669
            			c-0.4619-2.6729-1.2373-5.0562-2.3262-7.1519c-1.0889-2.0947-2.5322-3.7939-4.3301-5.0977
            			c-1.7988-1.3032-4.0508-1.9551-6.7559-1.9551c-2.6729,0-4.8916,0.6519-6.6562,1.9551c-1.7656,1.3037-3.168,3.0112-4.207,5.1226
            			c-1.0391,2.1118-1.7656,4.4961-2.1777,7.1514c-0.4131,2.6562-0.6357,5.3374-0.668,8.0425v9.3047
            			c0.0322,2.7056,0.2637,5.3867,0.6924,8.0425c0.4287,2.6562,1.1631,5.0483,2.2031,7.1763
            			c1.0391,2.1279,2.4404,3.8525,4.2061,5.1719c1.7646,1.3203,3.9844,1.98,6.6572,1.98c2.7051,0,4.957-0.6597,6.7559-1.98
            			c1.7979-1.3193,3.2412-3.0352,4.3301-5.147c1.0889-2.1113,1.8564-4.5039,2.3018-7.1763c0.4453-2.6729,0.6836-5.3618,0.7178-8.0674
            			V42.0742z"/>
            	</g>
            	<g>
            		<path style="fill:#FFFFFF;" d="M157.3115,64.6924l14.9961-53.9961h12.9668l-22.2715,72.0605h-11.333l-22.2227-72.0605h12.9668
            			L157.3115,64.6924z"/>
            	</g>
            	<g>
            		<path style="fill:#FFFFFF;" d="M196.8066,10.6963h42.8604v9.8491h-15.5898v52.4121h15.5898v9.7993h-42.8604v-9.7993h15.2432
            			V20.5454h-15.2432V10.6963z"/>
            	</g>
            	<g>
            		<path style="fill:#FFFFFF;" d="M255.4541,82.7568V10.6963h17.6192c4.9492,0.0332,9.3955,0.8584,13.3379,2.4746
            			c3.9424,1.6172,7.292,3.8936,10.0469,6.8301c2.7549,2.937,4.875,6.4424,6.3604,10.5171
            			c1.4844,4.0752,2.2432,8.5869,2.2764,13.5361v5.4438c-0.0332,4.9492-0.792,9.4614-2.2764,13.5361
            			c-1.4854,4.0752-3.5967,7.5723-6.335,10.4922c-2.7393,2.9204-6.0557,5.189-9.9482,6.8052
            			c-3.8936,1.6172-8.2646,2.4253-13.1152,2.4253H255.4541z M267.5303,20.2979v52.9072h5.8896
            			c3.2666-0.0327,6.1201-0.6187,8.5625-1.7573c2.4414-1.1382,4.4785-2.7383,6.1123-4.8008
            			c1.6328-2.0615,2.8535-4.5444,3.6621-7.4482c0.8076-2.9033,1.2285-6.1372,1.2617-9.7007v-5.543
            			c-0.0332-3.4644-0.4541-6.6318-1.2617-9.5024c-0.8086-2.8706-2.0381-5.353-3.6875-7.4487
            			c-1.6504-2.0947-3.7197-3.728-6.2109-4.8994c-2.4922-1.1709-5.4199-1.7734-8.7852-1.8066H267.5303z"/>
            	</g>
            </g>
            </svg>

              </router-link>
            </a>

            <div class="menu-wrapper">

              <label for="menu-toggle" class="pointer-cursor lg:hidden">
                         <svg class="fill-current text-gray-900" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><title>menu</title>
                           <path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"></path>
                         </svg>
                       </label>
              <input class="hidden" type="checkbox" id="menu-toggle" />

              <div class="hidden lg:flex lg:items-center lg:w-auto w-full" id="menu">
                <div class="nav">

                  <div>
                    <router-link :to="{ name: 'Topic', params: { topicName: 'explainers' } }">
                      <span class="explainers bullet"></span> The Science
                    </router-link>
                  </div>

                  <div>
                    <a href="#" class="brand-logo">
                      <router-link :to="{ name: 'Topic', params: { topicName: 'questions' } }">
                        <span class="questions bullet"></span> Your Questions
                      </router-link>
                    </a>
                  </div>

                  <div>
                    <router-link :to="{ name: 'Glossary'}">
                      Glossary
                    </router-link>
                  </div>

                  <div>
                    <a href="#">
                      <router-link :to="{ name: 'AboutUs' }">About Us</router-link>
                    </a>
                  </div>
                  <div>
                    <a href="#">
                      <router-link :to="{ name: 'OurSources' }">Our Sources</router-link>
                    </a>
                  </div>
                  <div>
                    <a href="#">
                      <router-link :to="{ name: 'ContactUs' }">Contact Us</router-link>
                    </a>
                  </div>

                </div>
              </div>

            </div>

            <ul class="if-admin">
              <li v-if="!admin">
                <a href="#">
                  <router-link class="white-text admin-links" :to="{ name: 'AdminLogin' }">Admin Log In</router-link>
                </a>
              </li>
              <li v-if="admin">
                <a href="#">
                          <a class="white-text admin-links" @click="redirectToAddPost"
                            >Create New Post</a
                          >
                        </a>
              </li>
              <li v-if="admin">
                <a href="#">
                          <a class="white-text admin-links" @click="logout">Log Out</a>
                </a>
              </li>
            </ul>
          </div>

</template>

<script>

  import firebase from 'firebase'
  import db from '@/firebase/init'
  export default {
    data: () => {
      return {
        admin: null,
        adminFromDb: null,
        isSuperAdmin: false,
        isApproved: false
      }
    },
    methods: {
      logout() {
        firebase
          .auth()
          .signOut()
          .then(() => {
            this.$router.push({ name: 'AdminLogin' })
          })
      },
      redirectToAddPost() {
        this.$router.push({ name: 'AddPost' })
      },

      checkApprovalStatus(adminId) {
        console.log('adminId:', adminId)
        db.collection('users')
          .doc(adminId)
          .get()
          .then(doc => {
            console.log('doc:', doc.data())
            // let adminFromDb = doc.data();
            // adminFromDb.id = doc.id;
            // this.adminFromDb = adminFromDb;
          })
          .then(() => {
            console.log('this.adminFromDb:', this.adminFromDb)
            // if (this.adminFromDb.isApproved === true) {
            //   this.isApproved = true;
            // }
          })
      },

      checkIfAdminIsSuperAdmin() {
        if (this.admin.email === 'liv@someemail.com') {
          this.isSuperAdmin = true
        }
      }
    },
    created() {
      //let admin = firebase.auth().currentUser;
      firebase.auth().onAuthStateChanged(admin => {
        if (admin) {
          this.admin = admin
          console.log('this.admin:', this.admin.id)
          //this.checkApprovalStatus(this.admin.id);
          this.checkIfAdminIsSuperAdmin()
        } else {
          this.admin = null
        }
      })
    }
  }

</script>

<style scoped>

  .container {
    z-index: 3;
  }
  .nav {
    display: flex;
    background: #f7f9fc;
    padding: 1rem;

  }

  @media (max-width: 1024px) {
    .menu-wrapper label {
      float: right;
    }
    .nav {
      flex-direction: column;
    }
  }
  .nav div {
    padding: 0 1rem;
  }

  .bullet {
    display: inline-block;
    width: 10px;
    height: 10px;
  }

  .container .if-admin {
    position: fixed;
    bottom: 0px;
    left: 0px;
    z-index: 5;
  }

  .nav div:hover {
    opacity: 0.75;
  }

  .admin-links {
    font-size: 12px;
    background: #f7f9fc;
    padding: 1rem;
  }
  .menu-wrapper {
    position: fixed;
    top: 20px;
    right: 40px;
  }
  #menu-toggle,
  .menu-wrapper label {
    cursor: pointer;
    height: 32px;
  }

  .site-name {
    position: fixed;
    top: 20px;
    left: 16px;
    padding: 0;
    font-size: 20px;
    z-index: 5;
  }

  .site-name svg {
    width: 140px;
    height: auto;
  }

  #menu-toggle:checked + #menu {
    display: block;
  }

</style>
